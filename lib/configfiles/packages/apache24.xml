<?xml version="1.0" encoding="UTF-8"?>
<froxlor>
	<service type="http" title="{{lng.admin.configfiles.http}}">
		<!-- general HTTP commands -->
		<general>
			<commands index="1">
				<command>
					<visibility mode="isdir">{{settings.system.apacheconf_vhost}}
					</visibility>
					<content><![CDATA[mkdir -p {{settings.system.apacheconf_vhost}}]]></content>
				</command>
				<command>
					<visibility mode="isfile">{{settings.system.apacheconf_vhost}}
					</visibility>
					<content><![CDATA[touch {{settings.system.apacheconf_vhost}}]]></content>
				</command>
				<command><![CDATA[chown root:0 {{settings.system.apacheconf_vhost}}]]></command>
				<command><![CDATA[chmod 0600 {{settings.system.apacheconf_vhost}}]]></command>
				<command>
					<visibility mode="isdir">{{settings.system.apacheconf_diroptions}}
					</visibility>
					<content><![CDATA[mkdir -p {{settings.system.apacheconf_diroptions}}]]></content>
				</command>
				<command>
					<visibility mode="isfile">{{settings.system.apacheconf_diroptions}}
					</visibility>
					<content><![CDATA[touch {{settings.system.apacheconf_diroptions}}]]></content>
				</command>
				<command><![CDATA[chown root:0 {{settings.system.apacheconf_diroptions}}]]></command>
				<command><![CDATA[chmod 0600 {{settings.system.apacheconf_diroptions}}]]></command>
				<command><![CDATA[mkdir -p {{settings.system.apacheconf_htpasswddir}}]]></command>
				<command><![CDATA[mkdir -p {{settings.system.documentroot_prefix}}]]></command>
				<command><![CDATA[mkdir -p {{settings.system.logfiles_directory}}]]></command>
				<command><![CDATA[mkdir -p {{settings.system.mod_fcgid_tmpdir}}]]></command>
				<command><![CDATA[chmod 1777 {{settings.system.mod_fcgid_tmpdir}}]]></command>
				<command>
					<visibility mode="notempty">{{settings.system.deactivateddocroot}}
					</visibility>
					<content><![CDATA[mkdir -p {{settings.system.deactivateddocroot}}]]></content>
				</command>
			</commands>
		</general>
		<!-- HTTP Apache -->
		<daemon name="apache" version="2.4" title="Apache 2.4"
			default="true">
			<include>//service[@type='http']/general/commands</include>
			<file name="{{settings.system.letsencryptacmeconf}}">
				<visibility mode="true">{{settings.system.leenabled}}
				</visibility>
				<content><![CDATA[
	Alias "/.well-known/acme-challenge" "{{settings.system.letsencryptchallengepath}}/.well-known/acme-challenge"
	<Directory "{{settings.system.letsencryptchallengepath}}/.well-known/acme-challenge">
	Require all granted
	</Directory>
	]]>
				</content>
			</file>
			<command><![CDATA[{{settings.system.apachereload_command}}]]></command>
		</daemon>
	</service>
</froxlor>
